function wrap(t,a){t.each(function(){for(var t,e=d3.select(this),r=e.text().split(/\s+/).reverse(),s=[],n=0,l=1.1,i=e.attr("x"),o=e.attr("y"),c=parseFloat(e.attr("dy")),d=e.text(null).append("tspan").attr("x",i).attr("y",o).attr("dy",c+"em");t=r.pop();)s.push(t),d.text(s.join(" ")),d.node().getComputedTextLength()>a&&(s.pop(),d.text(s.join(" ")),s=[t],d=e.append("tspan").attr("x",i).attr("y",o).attr("dy",++n*l+c+"em").text(t))})}var RadarChart={draw:function(t,a,e){var r={radius:5,w:600,h:600,factor:1,factorLegend:.85,levels:3,maxValue:0,radians:2*Math.PI,opacityArea:.5,ToRight:5,TranslateX:100,TranslateY:30,ExtraWidthX:100,ExtraWidthY:100,color:d3.scale.category10()};if("undefined"!=typeof e)for(var s in e)"undefined"!=typeof e[s]&&(r[s]=e[s]);r.maxValue=Math.max(r.maxValue,d3.max(a,function(t){return d3.max(t.map(function(t){return t.value}))}));{var n=a[0].map(function(t){return t.axis}),l=n.length,i=r.factor*Math.min(r.w/2,r.h/2);d3.format("%")}d3.select(t).select("svg").remove();for(var o=r.w+r.ExtraWidthX,c=r.h+r.ExtraWidthY,d=d3.select(t).append("svg").attr("width",o).attr("height",c).attr("viewBox","0 0 "+o+" "+c).attr("perserveAspectRatio","xMinYMid").append("g").attr("transform","translate("+r.TranslateX+","+r.TranslateY+")"),u=0;u<r.levels-1;u++){var f=r.factor*i*((u+1)/r.levels);d.selectAll(".levels").data(n).enter().append("svg:line").attr("x1",function(t,a){return f*(1-r.factor*Math.sin(a*r.radians/l))}).attr("y1",function(t,a){return f*(1-r.factor*Math.cos(a*r.radians/l))}).attr("x2",function(t,a){return f*(1-r.factor*Math.sin((a+1)*r.radians/l))}).attr("y2",function(t,a){return f*(1-r.factor*Math.cos((a+1)*r.radians/l))}).attr("class","line").style("stroke","grey").style("stroke-opacity","0.75").style("stroke-width","0.3px").attr("transform","translate("+(r.w/2-f)+", "+(r.h/2-f)+")")}series=0;var h=d.selectAll(".axis").data(n).enter().append("g").attr("class","axis");h.append("line").attr("x1",r.w/2).attr("y1",r.h/2).attr("x2",function(t,a){return r.w/2*(1-r.factor*Math.sin(a*r.radians/l))}).attr("y2",function(t,a){return r.h/2*(1-r.factor*Math.cos(a*r.radians/l))}).attr("class","line").style("stroke","grey").style("stroke-width","1px"),h.append("text").attr("class","legend").text(function(t){return t}).style("font-family","Raleway").style("font-size","1em").style("font-weight","bold").style("fill","#fff").attr("text-anchor","middle").attr("dy","1.5em").attr("transform",function(){return"translate(10, -20)"}).attr("x",function(t,a){return r.w/2*(1-r.factorLegend*Math.sin(a*r.radians/l)*1.1)-60*Math.sin(a*r.radians/l)}).attr("y",function(t,a){return r.h/2*(1-1.02*Math.cos(a*r.radians/l))-20*Math.cos(a*r.radians/l)}),h.selectAll(".axis text").call(wrap,170),a.forEach(function(t){dataValues=[],d.selectAll(".nodes").data(t,function(t,a){dataValues.push([r.w/2*(1-parseFloat(Math.max(t.value,0))/r.maxValue*r.factor*Math.sin(a*r.radians/l)),r.h/2*(1-parseFloat(Math.max(t.value,0))/r.maxValue*r.factor*Math.cos(a*r.radians/l))])}),dataValues.push(dataValues[0]),d.selectAll(".area").data([dataValues]).enter().append("polygon").attr("class","radar-chart-serie"+series).style("stroke-width","2px").style("stroke",r.color(series)).attr("points",function(t){for(var a="",e=0;e<t.length;e++)a=a+t[e][0]+","+t[e][1]+" ";return a}).style("fill",function(){return r.color(series)}).style("fill-opacity",r.opacityArea),series++}),series=0,a.forEach(function(t){d.selectAll(".nodes").data(t).enter().append("svg:circle").attr("class","radar-chart-serie"+series).attr("r",r.radius).attr("alt",function(t){return Math.max(t.value,0)}).attr("cx",function(t,a){return dataValues.push([r.w/2*(1-parseFloat(Math.max(t.value,0))/r.maxValue*r.factor*Math.sin(a*r.radians/l)),r.h/2*(1-parseFloat(Math.max(t.value,0))/r.maxValue*r.factor*Math.cos(a*r.radians/l))]),r.w/2*(1-Math.max(t.value,0)/r.maxValue*r.factor*Math.sin(a*r.radians/l))}).attr("cy",function(t,a){return r.h/2*(1-Math.max(t.value,0)/r.maxValue*r.factor*Math.cos(a*r.radians/l))}).attr("data-id",function(t){return t.axis}).style("fill",r.color(series)).style("fill-opacity",.9).on("mouseover",function(){newX=parseFloat(d3.select(this).attr("cx"))-10,newY=parseFloat(d3.select(this).attr("cy"))-5,z="polygon."+d3.select(this).attr("class"),d.selectAll("polygon").transition(200).style("fill-opacity",.1),d.selectAll(z).transition(200).style("fill-opacity",.7)}).append("svg:title").text(function(t){return Math.max(t.value,0)}),series++})}};